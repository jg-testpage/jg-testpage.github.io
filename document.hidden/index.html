<!DOCTYPE html>
<body>
  <button onclick="document.getElementById('stuff').innerHTML = ''">clear</button>
  <br>
  <div id="stuff"></div>
</body>
<script>
  document.addEventListener("visibilitychange", function() {
    document.getElementById('stuff').innerHTML +=
      't=' + Math.round(performance.now()) +
      '; visibilitychange: <span style="background-color: #ffc">transitioned to ' + document.visibilityState + '</span><br>';
  });

  function checkHidden() {
    var hidden = document.hidden;
    var text = 't=' + Math.round(performance.now()) +
      '; document.hidden = ' + hidden +
      '; document.visibilityState = ' + document.visibilityState + '<br>';
    if (hidden) {
      text = '<span style="background-color: #fcc">' + text + '</span>';
    }
    document.getElementById('stuff').innerHTML += text;
  } 
  checkHidden();
  setInterval(checkHidden, 500);
</script>